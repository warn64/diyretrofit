{"version":3,"sources":["components/autocomplete.js"],"names":["dmx","Component","extends","initialData","selectedItem","attributes","data","type","Array","default","matchcase","Boolean","matchstart","matchaccent","optiontext","String","optionvalue","optionsearch","noresultslabel","placeholder","noclear","events","noresults","Event","render","node","BaseComponent","prototype","call","this","dataItems","props","value","updateValue","$node","disabled","setAttribute","input","cloneNode","removeAttribute","addEventListener","onBlur","bind","onInput","onKeydown","list","document","createElement","style","display","updateData","update","mounted","parentNode","insertBefore","form","onReset","equal","repeatItems","map","item","index","label","parse","DataScope","search","updated","setValue","event","find","set","isDefault","defaultValue","focus","disable","valid","i","length","dispatchEvent","closeList","currentFocus","innerHTML","forEach","matches","div","getItemHtml","preventDefault","stopPropagation","appendChild","children","textContent","showList","keyCode","updateActive","divs","getElementsByTagName","MouseEvent","normalize","toLowerCase","substring","indexOf","html","htmlEncode","matcher","RegExp","escapeRegExp","replace","m","str","result","split","c","charCodeAt","fromCharCode","join","classList","remove","add","left","offsetLeft","top","offsetTop","offsetHeight","nextSibling","removeChild"],"mappings":"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","file":"../dmxAutocomplete/dmxAutocomplete.js","sourcesContent":["dmx.Component('autocomplete', {\r\n\r\n    extends: 'input',\r\n\r\n    initialData: {\r\n        selectedItem: null\r\n    },\r\n\r\n    attributes: {\r\n        data: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n\r\n        matchcase: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n\r\n        matchstart: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n\r\n        matchaccent: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n\r\n        optiontext: {\r\n            type: String,\r\n            default: '$value'\r\n        },\r\n\r\n        optionvalue: {\r\n            type: String,\r\n            default: '$value'\r\n        },\r\n\r\n        optionsearch: {\r\n            type: String,\r\n            default: null\r\n        },\r\n\r\n        noresultslabel: {\r\n            type: String,\r\n            default: 'No Results...'\r\n        },\r\n\r\n        placeholder: {\r\n            type: String,\r\n            default: ''\r\n        },\r\n\r\n        noclear: {\r\n            type: Boolean,\r\n            default: false\r\n        }\r\n    },\r\n\r\n    events: {\r\n        noresults: Event\r\n    },\r\n\r\n    render: function(node) {\r\n        dmx.BaseComponent.prototype.render.call(this, node);\r\n\r\n        this.dataItems = [];\r\n\r\n        if (!this.props.value) {\r\n            this.props.value = this.$node.value;\r\n        } else {\r\n            this.updateValue = true;\r\n        }\r\n\r\n        this.$node.disabled = this.props.disabled;\r\n        this.$node.setAttribute('placeholder', this.props.placeholder);\r\n\r\n        this.input = this.$node.cloneNode();\r\n        this.input.removeAttribute('id');\r\n        this.input.removeAttribute('name');\r\n        this.input.setAttribute('placeholder', this.props.placeholder);\r\n        this.input.setAttribute('autocomplete', 'off');\r\n        this.input.setAttribute('form', 'dummy'); // form should ignore this input\r\n        this.input.addEventListener('blur', this.onBlur.bind(this));\r\n        this.input.addEventListener('input', this.onInput.bind(this));\r\n        this.input.addEventListener('keydown', this.onKeydown.bind(this));\r\n\r\n        this.list = document.createElement('div');\r\n        this.list.setAttribute('class', 'dmx-autocomplete-items');\r\n\r\n        this.$node.style.display = 'none';\r\n        this.$node.addEventListener('change', this.updateData.bind(this));\r\n        this.$node.addEventListener('invalid', this.updateData.bind(this));\r\n\r\n        this.update({});\r\n    },\r\n\r\n    mounted: function() {\r\n        this.$node.parentNode.insertBefore(this.input, this.$node);\r\n\r\n        if (this.$node.form) {\r\n            this.$node.form.addEventListener('reset', this.onReset.bind(this));\r\n        }\r\n    },\r\n\r\n    update: function(props) {\r\n        if (!dmx.equal(this.props.data, props.data) || this.props.optiontext != props.optiontext || this.props.optionvalue != props.optionvalue) {\r\n            this.dataItems = dmx.repeatItems(this.props.data).map(function(item, index) {\r\n                const label = dmx.parse(this.props.optiontext, dmx.DataScope(item, this));\r\n                const value = dmx.parse(this.props.optionvalue, dmx.DataScope(item, this));\r\n                const search = this.props.optionsearch ? dmx.parse(this.props.optionsearch, dmx.DataScope(item, this)) : label;\r\n                return { index, label, value, search, item };\r\n            }, this);\r\n\r\n            this.updateValue = true;\r\n        }\r\n\r\n        if (this.props.value != props.value) {\r\n            this.updateValue = true;\r\n        }\r\n\r\n        if (this.props.disabled != props.disabled) {\r\n            this.$node.disabled = this.props.disabled;\r\n            this.input.disabled = this.props.disabled;\r\n        }\r\n\r\n        if (this.props.placeholder != props.placeholder) {\r\n            this.input.setAttribute('placeholder', this.props.placeholder);\r\n        }\r\n\r\n        this.updateData();\r\n    },\r\n\r\n    updated: function() {\r\n        if (this.updateValue) {\r\n            this.updateValue = false;\r\n            this.setValue(this.props.value, true);\r\n            this.updateData();\r\n        }\r\n    },\r\n\r\n    updateData: function(event) {\r\n        dmx.Component('form-element').prototype.updateData.call(this, event);\r\n        var selectedItem = this.dataItems.find(function(item) {\r\n            return item.value == this.$node.value;\r\n        }, this);\r\n        this.set('selectedItem', selectedItem ? selectedItem.item : null);\r\n    },\r\n\r\n    setValue: function(value, isDefault) {\r\n        var selectedItem = this.dataItems.find(function(item) {\r\n            return item.value == value;\r\n        }, this);\r\n\r\n        this.$node.value = selectedItem ? selectedItem.value : '';\r\n        this.input.value = selectedItem ? selectedItem.label : '';\r\n\r\n        if (isDefault) {\r\n            this.$node.defaultValue = selectedItem ? selectedItem.value : '';\r\n            this.input.defaultValue = selectedItem ? selectedItem.label : '';\r\n        }\r\n    },\r\n\r\n    focus: function() {\r\n        this.input.focus();\r\n    },\r\n\r\n    disable: function(disable) {\r\n        this.$node.disabled = (disable === true);\r\n        this.input.disabled = (disable === true);\r\n        this.updateData();\r\n    },\r\n\r\n    onReset: function(event) {\r\n        this.$node.value = this.$node.defaultValue;\r\n        this.input.value = this.input.defaultValue;\r\n    },\r\n\r\n    onBlur: function(event) {\r\n        var valid = false;\r\n\r\n        if (this.dataItems) {\r\n            for (var i = 0; i < this.dataItems.length; i++) {\r\n                if (this.dataItems[i].label == this.input.value) {\r\n                    this.$node.value = this.dataItems[i].value;\r\n                    valid = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!valid) {\r\n            if (this.props.noclear) {\r\n                this.$node.value = this.input.value;\r\n            } else {\r\n                this.input.value = '';\r\n                this.$node.value = '';\r\n            }\r\n        }\r\n\r\n        this.$node.dispatchEvent(new Event('change'));\r\n\r\n        this.closeList();\r\n    },\r\n\r\n    onInput: function(event) {\r\n        var $node = this.$node;\r\n        var input = this.input;\r\n        var value = input.value;\r\n\r\n        this.closeList();\r\n\r\n        if (!value) return;\r\n\r\n        this.currentFocus = -1;\r\n        this.list.innerHTML = '';\r\n\r\n        this.dataItems.forEach(function(item) {\r\n            if (this.matches(item.search, value)) {\r\n                var div = document.createElement('div');\r\n                div.setAttribute('class', 'dmx-autocomplete-item');\r\n                div.innerHTML = this.getItemHtml(item.label, value);\r\n                div.item = item;\r\n\r\n                div.addEventListener('mousedown', (event) => {\r\n                    event.preventDefault();\r\n                    event.stopPropagation();\r\n                    $node.value = item.value;\r\n                    input.value = item.label;\r\n                    this.closeList();\r\n                    $node.dispatchEvent(new Event('change'));\r\n                });\r\n\r\n                this.list.appendChild(div);\r\n            }\r\n        }, this);\r\n\r\n        if (!this.list.children.length) {\r\n            var div = document.createElement('div');\r\n            div.setAttribute('class', 'dmx-autocomplete-item');\r\n            div.textContent = this.props.noresultslabel;\r\n            div.addEventListener('mousedown', (event) => {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                this.closeList();\r\n                this.dispatchEvent('noresults', null, { value: value });\r\n            });\r\n            this.list.appendChild(div);\r\n        }\r\n\r\n        this.showList();\r\n    },\r\n\r\n    onKeydown: function(event) {\r\n        if (event.keyCode == 40) {\r\n            event.preventDefault();\r\n            this.currentFocus++;\r\n            this.updateActive();\r\n            this.showList();\r\n        } else if (event.keyCode == 38) {\r\n            event.preventDefault();\r\n            this.currentFocus--;\r\n            this.updateActive();\r\n            this.showList();\r\n        } else if (event.keyCode == 27) {\r\n            event.preventDefault();\r\n            this.currentFocus = -1;\r\n            this.closeList();\r\n        } else if (event.keyCode == 13) {\r\n            // prevent the form from being submitted\r\n            event.preventDefault();\r\n\r\n            if (this.currentFocus > -1) {\r\n                const divs = this.list.getElementsByTagName('div');\r\n                if (divs) divs[this.currentFocus].dispatchEvent(new MouseEvent('mousedown'));\r\n            }\r\n        }\r\n    },\r\n\r\n    matches: function(item, value) {\r\n        if (item == null) return false;\r\n\r\n        if (!this.props.matchaccent) {\r\n            item = this.normalize(item);\r\n            value = this.normalize(value);\r\n        }\r\n\r\n        if (!this.props.matchcase) {\r\n            item = item.toLowerCase();\r\n            value = value.toLowerCase();\r\n        }\r\n\r\n        if (this.props.matchstart) {\r\n            item = item.substring(0, value.length);\r\n        }\r\n\r\n        return item.indexOf(value) != -1;\r\n    },\r\n\r\n    getItemHtml: function(item, value) {\r\n        var html = this.htmlEncode(item);\r\n        var matcher = new RegExp((this.props.matchstart ? '^' : '') + dmx.escapeRegExp(this.htmlEncode(value)), this.props.matchcase ? 'g' : 'gi');\r\n\r\n        html = html.replace(matcher, function(m) {\r\n            return '<b>' + m + '</b>';\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    htmlEncode: function(html) {\r\n        html = html.replace(/&/g, '&amp;');\r\n        html = html.replace(/\"/g, '&quot;');\r\n        html = html.replace(/</g, '&lt;');\r\n        html = html.replace(/>/g, '&gt;');\r\n        return html;\r\n    },\r\n\r\n    normalize: function(str) {\r\n        if (str.normalize) {\r\n            return str.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '');\r\n        }\r\n\r\n        var TAB_00C0 = 'AAAAAAACEEEEIIIIDNOOOOO*OUUUUYIsaaaaaaaceeeeiiii?nooooo/ouuuuy?yAaAaAaCcCcCcCcDdDdEeEeEeEeEeGgGgGgGgHhHhIiIiIiIiIiJjJjKkkLlLlLlLlLlNnNnNnnNnOoOoOoOoRrRrRrSsSsSsSsTtTtTtUuUuUuUuUuUuWwYyYZzZzZzF';\r\n        var result = str.split('');\r\n\r\n        for (var i = 0; i < result.length; i++) {\r\n            var c = str.charCodeAt(i);\r\n            if (c >= 0x00c0 && c <= 0x017f) {\r\n                result[i] = String.fromCharCode(TAB_00C0.charCodeAt(c - 0x00c0));\r\n            } else if (c > 127) {\r\n                result[i] = '?';\r\n            }\r\n        }\r\n\r\n        return result.join('');\r\n    },\r\n\r\n    updateActive: function() {\r\n        var divs = this.list.getElementsByTagName('div');\r\n\r\n        if (!divs) return;\r\n        if (this.currentFocus >= divs.length) this.currentFocus = 0;\r\n        if (this.currentFocus < 0) this.currentFocus = divs.length - 1;\r\n\r\n        for (var i = 0; i < divs.length; i++) {\r\n            divs[i].classList.remove('dmx-autocomplete-active');\r\n        }\r\n\r\n        divs[this.currentFocus].classList.add('dmx-autocomplete-active');\r\n    },\r\n\r\n    showList: function() {\r\n        if (!this.input.value) return;\r\n\r\n        this.list.style.left = this.input.offsetLeft + 'px';\r\n        this.list.style.top = (this.input.offsetTop + this.input.offsetHeight) + 'px';\r\n\r\n        if (this.$node.nextSibling) {\r\n            this.$node.parentNode.insertBefore(this.list, this.$node.nextSibling);\r\n        } else {\r\n            this.$node.parentNode.appendChild(this.list);\r\n        }\r\n    },\r\n\r\n    closeList: function() {\r\n        if (this.list.parentNode) {\r\n            this.list.parentNode.removeChild(this.list);\r\n        }\r\n    }\r\n\r\n});\r\n"]}